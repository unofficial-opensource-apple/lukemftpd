# $Id: Makefile.in,v 1.3 2003/12/20 00:13:44 grant Exp $
#

srcdir	= @srcdir@
VPATH	= @srcdir@
SHELL	= /bin/sh

prefix	= @prefix@
exec_prefix = @exec_prefix@
bindir	= @bindir@
mandir	= @mandir@
sbindir	= @sbindir@
sysconfdir = @sysconfdir@

mandir5 = ${mandir}/man5
mandir8 = ${mandir}/man8

CC	= @CC@
CFLAGS	= -I${srcdir} -I${srcdir}/.. -I. -I.. @INCLUDES@ -DHAVE_TNFTPD_H=1 @CFLAGS@ -D_DEFAULT_CONFDIR=\"${sysconfdir}\"
LIBS   = @LIBS@ -lpam
LDFLAGS	= @LDFLAGS@

INSTALL	= @INSTALL@

PROG	= tnftpd
OBJS	= cmds.o conf.o ftpd.o ftpcmd.o popen.o @LSOBJS@
# removed: logutmp.o logwtmp.o

all:	${PROG}

cmp.o: ${srcdir}/../ls/cmp.c
	${CC} ${CFLAGS} -c  -o cmp.o ${srcdir}/../ls/cmp.c

ls.o: ${srcdir}/../ls/ls.c
	${CC} ${CFLAGS} -c  -o ls.o ${srcdir}/../ls/ls.c

print.o: ${srcdir}/../ls/print.c
	${CC} ${CFLAGS} -c  -o print.o ${srcdir}/../ls/print.c

util.o: ${srcdir}/../ls/util.c
	${CC} ${CFLAGS} -c  -o util.o ${srcdir}/../ls/util.c

install: all
	-mkdir -p ${sbindir}
	${INSTALL} -m 555 ${PROG} ${sbindir}
	-mkdir -p ${mandir5}
	${INSTALL} -m 444 ${srcdir}/ftpd.conf.5 ${mandir5}
	${INSTALL} -m 444 ${srcdir}/ftpusers.5 ${mandir5}
	-mkdir -p ${mandir8}
	${INSTALL} -m 444 ${srcdir}/ftpd.8 ${mandir8}/${PROG}.8
	ln -s ${PROG}.8 ${mandir8}/ftpd.8

${PROG}: ${OBJS} @LIBDEPENDS@
	${CC} ${CFLAGS} ${LDFLAGS} -o ${PROG} ${OBJS} ${LIBS}

clean:
	rm -f core ${PROG} ${OBJS}

distclean: clean
	rm -f Makefile
